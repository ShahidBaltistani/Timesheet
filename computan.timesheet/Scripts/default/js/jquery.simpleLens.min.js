/*!
 * jQuery Lens Simple Plugin
 * Copyright (c) 2014 Pietro Simone Di Chiara
 * Version: 1.0.1 (05-APR-2013)
 * Licensed under the MIT license:
 * http://www.opensource.org/licenses/mit-license.php
 * Requires: jQuery v1.7.0 or later
 */
(function(n){"use strict";function t(){window.console}var i="simpleLens-1.0.1";n.fn.simpleLens=function(i){var r=n.extend({},n.fn.simpleLens.defaults,i),u={init:function(n){this.height=n.height();this.width=n.width();this.offset=n.offset();this.position=n.position();this.calc_image_limits()},calc_image_limits:function(){this.limits={x_left:this.position.left,x_right:this.position.left+this.width,y_top:this.position.top,y_bottom:this.position.top+this.height}},calc_view_position:function(n){return{org_x:n.pageX-this.offset.left,org_y:n.pageY-this.offset.top}}},f={init:function(n,t,i,r){this.parent_anchor=n;this.lens_container=t;this.ratio=i;this.cursor_position={top:0,left:0};this.calc_cursor_size();this.insert_cursor(r.org_x,r.org_y)},destroy:function(){n("."+r.cursor_class).remove()},calc_cursor_size:function(){this.cursor_height=this.lens_container.height()/this.ratio.x;this.cursor_width=this.lens_container.width()/this.ratio.y;this.height_center=this.cursor_height/2;this.width_center=this.cursor_width/2},update_cursor_position:function(n,t){var r=t-this.height_center,e=t+this.height_center,f=n-this.width_center,o=n+this.width_center,i=u.limits;parseFloat(i.y_top)>parseFloat(r)?r=i.y_top:parseFloat(e)>parseFloat(i.y_bottom)&&(r=i.y_bottom-this.cursor_height);parseFloat(i.x_left)>parseFloat(f)?f=i.x_left:parseFloat(o)>parseFloat(i.x_right)&&(f=i.x_right-this.cursor_width);this.cursor_position={top:r,left:f,center_top:r+this.height_center,center_left:f+this.width_center};this.cursor!==undefined&&this.cursor.css(this.cursor_position)},insert_cursor:function(t,i){return this.cursor=n("<div>",{"class":r.cursor_class}),this.cursor.css({height:this.cursor_height+"px",width:this.cursor_width+"px"}),this.cursor.appendTo(this.parent_anchor),this.update_cursor_position(t,i)}},e={init:function(i){this.parent_anchor=i;this.parent_div=i.parent(r.parent_class);this.lens_image_url=i.attr(r.lens_image_attr);this.lens_container=n("<div>",{"class":r.lens_class});this.lens_image=n("<img>");u.init(i.find(r.big_image_class));this.lens_image_url===undefined&&(t("Cannot find lens image. URL: "+this.lens_image_url),t(that),t(i),t(lens_image_url))},update_lens_position:function(n){this.lens_image.css({top:n.top,left:n.left})},calc_lens_position:function(n){return{left:(n.center_left*this.ratio.x-this.container.width)*-1,top:(n.center_top*this.ratio.y-this.container.height)*-1}},lens_event_bind:function(){var n=this,t=function(t){var i=u.calc_view_position(t);f.update_cursor_position(i.org_x,i.org_y);n.update_lens_position(n.calc_lens_position(f.cursor_position,n.ratio,n.container))};this.parent_anchor.mousemove(t)},lens_event_unbind:function(){this.parent_anchor!==undefined&&this.parent_anchor.unbind("mousemove")},destroy:function(){f.destroy();this.lens_container!==undefined&&this.lens_container.length>0&&(n("."+r.lens_class).remove(),this.lens_event_unbind())},load:function(t){var i=this,e,o;this.lens_container.appendTo(this.parent_div);e=this.lens_container.height()/2-25;o=n("<img>",{src:r.loading_image}).css("margin-top",e);this.lens_container.html(o);this.lens_image.load(function(){i.lens_container.html(i.lens_image);i.container={width:i.lens_container.width()/2,height:i.lens_container.height()/2};i.img_size={width:i.lens_image.width(),height:i.lens_image.height()};i.ratio={y:i.lens_image.height()/u.height,x:i.lens_image.width()/u.width};var n=u.calc_view_position(t);f.init(i.parent_anchor,i.lens_container,i.ratio,n);i.update_lens_position(i.calc_lens_position(f.cursor_position));i.lens_event_bind()}).attr("src",this.lens_image_url)}},o=function(t){var i=n(this);e.init(i);e.load(t)},s=function(){e.destroy()};n(this).parents(r.parent_class).on(r.open_lens_event,r.anchor_parent_class,o);n(this).parents(r.parent_class).on("mouseleave",r.anchor_parent_class,s)};n.fn.simpleLens.ver=function(){return i};n.fn.simpleLens.defaults={anchor_parent_class:".simpleLens-lens-image",lens_image_attr:"data-lens-image",big_image_class:".simpleLens-big-image",parent_class:".simpleLens-big-image-container",lens_class:"simpleLens-lens-element",cursor_class:"simpleLens-mouse-cursor",loading_image:"../img/view-slider/loading.gif",open_lens_event:"mouseenter"}})(jQuery);