@{ ViewBag.Title = "List Contacts"; }
<div class="panel panel-default" id="maincontent">
    @Html.Partial("_NavTabs", "contacts")
    <div class="panel">
        <div class="panel-heading bg-teal-700">
            <div class="row">
                <div class="col-xs-12">
                    <div class="col-xs-12 col-sm-7">
                        <h4 class="panel-title ticket-title">
                            <span>Contacts Listing </span>
                        </h4>
                    </div>
                    <div class="col-xs-12 col-sm-5">
                        <div class="heading-elements">
                            <ul class="icons-list">
                                <li>
                                    <button class="label border-left-primary label-striped" onclick="window.location.href = '/contacts/create'">Add New Contact</button>
                                </li>
                                <li>
                                    <button class="label border-left-primary label-striped" onclick="window.location.href = '/ContactCompanies/Index'">List Companies</button>
                                </li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="panel panel-flat">
            <table class="display table" id="DataTables_Table_0" role="grid" aria-describedby="DataTables_Table_0_info">
                <thead>
                <tr role="row">
                    <th class="sorting_asc" tabindex="0" aria-controls="DataTables_Table_2" rowspan="1" colspan="1" aria-sort="ascending" aria-label="First Name: activate to sort column descending"> DisplayName </th>
                    <th> Email </th>
                    <th> Created Date </th>
                    <th> Status </th>
                    <th> Option </th>
                </tr>
                </thead>
            </table>
        </div>
    </div>
</div>
<input type="hidden" id="statusFilter" value="1"/>
<script type="text/javascript">
    $(document).ready(function() {
        var url = window.location.pathname;
        var id = url.substring(url.lastIndexOf('/') + 1);
        var ctable = $('#DataTables_Table_0').DataTable({
            "processing": true,
            "serverSide": true,
            "ordering": false,
            "scrollY": "600px",
            "scrollCollapse": true,
            "lengthMenu": [[10, 25, 50, -1], [10, 25, 50, "All"]],
            "ajax": {
                "url": "/Contacts/GetData",
                "type": "GET",
                "data": function(data) {
                    data.filter = $('#statusFilter').val() == 'null' ? null : ($('#statusFilter').val() == '1' ? true : false);
                    data.id = id;
                },
                "datatype": "json"
            },
            "columnDefs": [
                { "targets": 0, "data": "DisplayName", "render": function(data) { return "<div style='white-space: normal; max-width: 300px;'>" + data + "</div>"; } },
                { "targets": 1, "data": "Email", "render": function(data) { return "<div style='white-space: normal; max-width: 300px;'>" + data + "</div>"; } },
                { "targets": 2, "data": "createdonutc", "render": function(data) { return moment(data).format("D/MM/YYYY"); } },
                {
                    "targets": 3,
                    "data": "isactive",
                    "render": function(data) {
                        if (data == true) {
                            return '<span class="label label-success">Active</span>';
                        }
                        return '<span class="label label-danger">In-Active</span>';
                    }
                },
                { "targets": 4, "data": "id", "render": function(data) { return '<a class="btn btn-primary btn-xs" data-id="' + data + '" href="/Contacts/Edit/' + data + '" target="_blank">Edit</a>'; } }
            ],
            buttons: {
                dom: { button: { className: 'btn btn-default' } },
                buttons: [
                    { extend: 'copyHtml5', exportOptions: { columns: [0, 1, 2, 3] } },
                    { extend: 'excelHtml5', exportOptions: { columns: [0, 1, 2, 3] } },
                    { extend: 'csvHtml5', exportOptions: { columns: [0, 1, 2, 3] } },
                    { extend: 'pdfHtml5', exportOptions: { columns: [0, 1, 2, 3] } }
                ]
            }
        });
        $(".dataTables_length").before($("#status-radiobutton-template").html());
        $('input[name="optradio"]').change(function() {
            $('input[name="optradio"]').closest("label").removeClass('btn-primary').addClass('btn-default');
            $('#statusFilter').val($('input[name="optradio"]:checked').val());
            $('input[name="optradio"]:checked').closest("label").removeClass('btn-default').addClass('btn-primary');
            ctable.draw();
        });
        $('.dataTables_length select').select2({ minimumResultsForSearch: Infinity, width: 'auto' });
    });
</script>
<script id="status-radiobutton-template" type="text/x-handlebars-template">
    <div data-toggle="buttons" class="dt-buttons btn-group">
        <label class="btn btn-primary"> <input type="radio" name="optradio" value="1" checked="checked">Active </label>
        <label class="btn btn-default"> <input type="radio" name="optradio" value="0">In-Active </label>
        <label class="btn btn-default"> <input type="radio" name="optradio" value="null">All </label>
    </div>
</script>